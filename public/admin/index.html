
<!DOCTYPE html>
<html>
  <head>
    <meta charset="UTF-8" />
    <title>DropDeck Admin</title>
    <base href="/admin/" />
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Montserrat:wght@400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/js-yaml@4.1.0/dist/js-yaml.min.js"></script>
    <script src="https://unpkg.com/decap-cms@^3.0.0/dist/decap-cms.js"></script>
    <style>
      body {
        font-family: 'Poppins', sans-serif;
        background-color: #111;
        color: #fff;
      }
      .nc-appHeader-container {
        background-color: #1a1a1a !important;
      }
      .nc-appHeader-content {
        background-color: #1a1a1a !important;
      }
      .nc-appHeader-button {
        background-color: #333 !important;
        color: white !important;
      }
      .nc-entryListing-cardImage {
        background-size: contain !important;
        background-repeat: no-repeat !important;
        background-position: center !important;
      }
    </style>
  </head>
  <body>
    <script>
      window.CMS_MANUAL_INIT = true;

      // Initialize CMS
      window.initCMS = async () => {
        try {
          const response = await fetch('/admin/config.yml');
          const config = await response.text();
          const yaml = jsyaml.load(config);

          // Add password protection
          const checkPassword = function() {
            const password = prompt("Please enter password to access the CMS:");
            if (password !== "DEepu1234@&") {
              alert("Incorrect password. Access denied.");
              setTimeout(checkPassword, 100);
              return false;
            }
            return true;
          };

          if (!checkPassword()) {
            return;
          }

          // Configure backend
          if (yaml.backend) {
            yaml.backend.base_url = window.location.origin;
          }

          // Initialize CMS with config
          await CMS.init({ config: yaml });
        } catch (error) {
          console.error("Error initializing CMS:", error);
          document.body.innerHTML = `<div style="padding: 20px; color: white; text-align: center;">
            <h1>Error loading CMS</h1>
            <p>${error.message}</p>
          </div>`;
        }
      };

      // Initialize when DOM is ready
      document.addEventListener('DOMContentLoaded', initCMS);
    </script>
  </body>
</html>
